version: 2
exported_at: 2026-01-17T08:29:45.893798-06:00
task:
    id: TASK-396
    title: Create TimeRangeSelector component for timeline grouping
    description: |-
        Create a TimeRangeSelector component for collapsible date grouping in the timeline.

        **COMPONENT INTERFACE:**
        ```typescript
        interface TimeRangeSelectorProps {
          value: TimeRange;
          onChange: (range: TimeRange) => void;
          customRange?: { start: Date; end: Date };
          onCustomRangeChange?: (range: { start: Date; end: Date }) => void;
        }

        type TimeRange = 'today' | 'yesterday' | 'this_week' | 'this_month' | 'custom';
        ```

        **VISUAL DESIGN:**
        ```
        ┌─────────────────────────────────────────────────────────┐
        │  Today  │  Yesterday  │  This Week  │  This Month  │  ⚙  │
        └─────────────────────────────────────────────────────────┘
                   ↓ (when custom selected)
        ┌─────────────────────────────────────────────────────────┐
        │  From: [Jan 10, 2026 ▾]    To: [Jan 16, 2026 ▾]        │
        └─────────────────────────────────────────────────────────┘
        ```

        **TAB STYLING (following example_ui patterns):**
        ```css
        .time-range-tabs {
          display: flex;
          gap: 4px;
          background: var(--bg-surface);
          padding: 4px;
          border-radius: 8px;
        }

        .time-range-tab {
          padding: 6px 12px;
          border-radius: 6px;
          font-size: var(--text-sm);
          color: var(--text-secondary);
          cursor: pointer;
          transition: all 0.15s;
        }

        .time-range-tab:hover {
          color: var(--text-primary);
        }

        .time-range-tab.active {
          background: var(--bg-card);
          color: var(--text-primary);
        }
        ```

        **DATE RANGE CALCULATION:**
        ```typescript
        function getDateRange(range: TimeRange): { since: Date; until: Date } {
          const now = new Date();
          switch (range) {
            case 'today':
              return { since: startOfDay(now), until: now };
            case 'yesterday':
              return { since: startOfDay(subDays(now, 1)), until: endOfDay(subDays(now, 1)) };
            case 'this_week':
              return { since: startOfWeek(now), until: now };
            case 'this_month':
              return { since: startOfMonth(now), until: now };
            case 'custom':
              // Use customRange prop
          }
        }
        ```

        **FILES TO CREATE:**
        - web/src/components/timeline/TimeRangeSelector.tsx

        **SUCCESS CRITERIA:**
        1. All preset ranges work correctly
        2. Custom date picker appears when custom selected
        3. Tab styling matches design system
        4. Date calculations handle timezone correctly
        5. Keyboard accessible (arrow keys to navigate tabs)
    weight: small
    status: planned
    branch: orc/TASK-396
    queue: active
    priority: normal
    category: feature
    initiative_id: INIT-024
    blocked_by:
        - TASK-335
    created_at: 2026-01-16T22:55:56-06:00
    updated_at: 0001-01-01T00:00:00Z
plan:
    version: 1
    task_id: TASK-396
    weight: small
    description: Small task - implement with tests, fully automated
    phases:
        - id: implement
          name: implement
          prompt: |
            Implement the following task:

            **Task**: {{TASK_TITLE}}

            **Description**: {{TASK_DESCRIPTION}}

            {{RETRY_CONTEXT}}

            1. Implement the required changes
            2. Write/update tests as needed
            3. Run tests and fix any failures

            Keep iterating until implementation is complete and all tests pass.

            When done, output:
            <phase_complete>true</phase_complete>
          gate:
            type: auto
          checkpoint: true
          status: pending
        - id: test
          name: test
          prompt: |
            Final test verification for: {{TASK_TITLE}}

            **Original task**: {{TASK_DESCRIPTION}}

            1. Run the full test suite
            2. Fix any failures found
            3. Verify edge cases are covered

            Keep iterating until all tests pass.

            When done, output:
            <phase_complete>true</phase_complete>
          depends_on:
            - implement
          gate:
            type: auto
          checkpoint: true
          status: pending
state:
    task_id: TASK-396
    current_phase: ""
    current_iteration: 0
    status: pending
    started_at: 0001-01-01T00:00:00Z
    updated_at: 0001-01-01T00:00:00Z
    phases: {}
    tokens:
        input_tokens: 0
        output_tokens: 0
        total_tokens: 0
    cost:
        total_cost_usd: 0
