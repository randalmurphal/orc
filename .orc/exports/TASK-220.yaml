version: 2
exported_at: 2026-01-17T22:16:37.548225499-06:00
task:
    id: TASK-220
    title: 'CLI: orc resolve should support --force for stuck running tasks'
    description: |-
        ## Problem
        When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks.

        ## Friction Encountered
        - TASK-179: stuck in running, PR merged, had to use direct DB update
        - TASK-201: stuck in running, PR merged, had to use direct DB update

        ## Proposed Solution
        Add `--force` flag to `orc resolve` that:
        1. Works on any status (not just failed)
        2. Checks if PR exists and is merged (auto-detect completion)
        3. Sets status to 'finished' if PR merged, 'completed' otherwise

        ## Example
        ```bash
        orc resolve TASK-201 --force  # Works even though status is 'running'
        orc resolve TASK-201 --force --message 'PR merged manually'
        ```

        ## Acceptance Criteria
        - `orc resolve --force` works on running/paused/blocked tasks
        - If task has merged PR, auto-sets to 'finished'
        - Warns user if no PR exists (might be incomplete work)
        - Updates phases to completed state
    weight: medium
    status: completed
    current_phase: docs
    branch: orc/TASK-220
    queue: active
    priority: normal
    category: bug
    created_at: 2026-01-15T11:52:44-06:00
    updated_at: 0001-01-01T00:00:00Z
    started_at: 2026-01-16T15:35:19-06:00
    completed_at: 2026-01-16T15:57:49-06:00
    metadata:
        pr_url: https://github.com/randalmurphal/orc/pull/180
plan:
    version: 1
    task_id: TASK-220
    weight: medium
    description: Medium task - spec, implement, test, docs with clear success criteria
    phases:
        - id: spec
          name: spec
          prompt: |
            Create a specification for this task:

            **Task**: {{TASK_TITLE}}
            **Category**: {{TASK_CATEGORY}}
            **Description**: {{TASK_DESCRIPTION}}

            {{INITIATIVE_CONTEXT}}

            ## Instructions

            Create a clear, actionable specification that defines exactly what needs to be done
            and how to verify it's complete.

            ### 1. Problem Statement
            Summarize what needs to be solved in 1-2 sentences.

            ### 2. Success Criteria (REQUIRED)
            Define specific, testable criteria as checkboxes:
            - Each criterion must be verifiable (file exists, test passes, API returns X)
            - No vague language ("works well", "is fast")
            - Include both functional and quality criteria

            ### 3. Testing Requirements (REQUIRED)
            Specify what tests must pass:
            - [ ] Unit test: [specific test description]
            - [ ] Integration test: [if applicable]
            - [ ] E2E test: [if UI changes]

            ### 4. Scope
            Define boundaries to prevent scope creep:
            - **In Scope**: What will be implemented
            - **Out of Scope**: What will NOT be implemented

            ### 5. Technical Approach
            Brief plan for implementation:
            - Files to modify
            - Key changes in each file

            ### 6. Category-Specific Analysis

            **If this is a BUG (category=bug):**
            - Reproduction Steps: Exact steps to trigger the bug
            - Current Behavior: What happens now (the bug)
            - Expected Behavior: What should happen
            - Root Cause: Where the bug originates (if known)
            - Verification: How to confirm the fix works

            **If this is a FEATURE (category=feature):**
            - User Story: As a [user], I want [feature] so that [benefit]
            - Acceptance Criteria: Specific conditions for feature acceptance

            **If this is a REFACTOR (category=refactor):**
            - Before Pattern: Current code/architecture
            - After Pattern: Target code/architecture
            - Risk Assessment: What could break

            ## Output Format

            Wrap your spec in artifact tags:

            <artifact>
            # Specification: {{TASK_TITLE}}

            ## Problem Statement
            [1-2 sentences]

            ## Success Criteria
            - [ ] [Criterion 1]
            - [ ] [Criterion 2]

            ## Testing Requirements
            - [ ] [Test 1]
            - [ ] [Test 2]

            ## Scope
            ### In Scope
            - [Item]
            ### Out of Scope
            - [Item]

            ## Technical Approach
            [Brief implementation plan]

            ### Files to Modify
            - [file]: [change]

            ## [Category-Specific Section]
            [Include appropriate section based on category]
            </artifact>

            After completing the spec, commit:
            ```bash
            git add -A
            git commit -m "[orc] {{TASK_ID}}: spec - completed"
            ```

            Then output:
            ```
            **Commit**: [SHA]
            <phase_complete>true</phase_complete>
            ```

            If blocked (requirements unclear):
            ```
            <phase_blocked>
            reason: [what's unclear]
            needs: [what clarification is needed]
            </phase_blocked>
            ```
          gate:
            type: auto
          checkpoint: true
          status: completed
          commit_sha: eeeae598fdb7144abbf0b8a90703ee160ad5ddb3
        - id: implement
          name: implement
          prompt: |
            Implement the task according to the specification:

            **Task**: {{TASK_TITLE}}
            **Category**: {{TASK_CATEGORY}}

            {{INITIATIVE_CONTEXT}}

            ## Specification

            {{SPEC_CONTENT}}

            {{RETRY_CONTEXT}}

            ## Instructions

            1. Review the spec's success criteria - these are your acceptance criteria
            2. Implement the required changes following the technical approach
            3. Write/update tests alongside code (as specified in Testing Requirements)
            4. Run tests and fix any failures
            5. Self-review against success criteria before completing

            ### Self-Review Checklist
            - [ ] All success criteria from spec addressed
            - [ ] All testing requirements satisfied
            - [ ] Scope boundaries respected (no extra features)
            - [ ] Error handling complete
            - [ ] Code follows project patterns

            Keep iterating until implementation is complete and tests pass.

            After completing, commit:
            ```bash
            git add -A
            git commit -m "[orc] {{TASK_ID}}: implement - completed"
            ```

            When done, output:
            ```
            **Commit**: [SHA]
            <phase_complete>true</phase_complete>
            ```
          depends_on:
            - spec
          gate:
            type: auto
          checkpoint: true
          status: completed
          commit_sha: e281ef54572dc52da8fc96105112a5189843ad57
        - id: test
          name: test
          prompt: |
            Test and review the implementation:

            **Task**: {{TASK_TITLE}}
            **Category**: {{TASK_CATEGORY}}

            ## Specification

            {{SPEC_CONTENT}}

            ## Instructions

            1. Run the full test suite
            2. Verify all Testing Requirements from spec are satisfied
            3. Review code for quality issues
            4. Check for edge cases and security issues
            5. Fix any problems found

            ### Verification Against Spec
            Go through each Success Criterion and Testing Requirement from the spec
            and verify it's satisfied.

            Keep iterating until all tests pass and code quality is acceptable.

            After completing, commit:
            ```bash
            git add -A
            git commit -m "[orc] {{TASK_ID}}: test - completed"
            ```

            When done, output:
            ```
            **Commit**: [SHA]
            <phase_complete>true</phase_complete>
            ```
          depends_on:
            - implement
          gate:
            type: auto
          checkpoint: true
          status: completed
          commit_sha: 0ee10fb0c3ed9f2829cbe47c4296a002ae09efce
        - id: docs
          name: docs
          prompt: |
            Update documentation for:

            **Task**: {{TASK_TITLE}}
            **Category**: {{TASK_CATEGORY}}

            ## Specification

            {{SPEC_CONTENT}}

            ## Instructions

            1. Update any relevant documentation files
            2. Ensure CLAUDE.md reflects the changes if applicable
            3. Add/update code comments where needed
            4. Update README if user-facing changes were made

            Keep iterating until documentation is complete.

            After completing, commit:
            ```bash
            git add -A
            git commit -m "[orc] {{TASK_ID}}: docs - completed"
            ```

            When done, output:
            ```
            **Commit**: [SHA]
            <phase_complete>true</phase_complete>
            ```
          depends_on:
            - test
          gate:
            type: auto
          checkpoint: true
          status: completed
          commit_sha: 09c32a9a437ee5cac395c08e9953792787453fcd
spec: |-
    # Specification: CLI: orc resolve should support --force for stuck running tasks

    ## Problem Statement

    When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks, requiring direct database updates for stuck running tasks.

    ## Success Criteria

    - [ ] `orc resolve TASK-XXX --force` works on tasks with any status (running, paused, blocked, created, planned, etc.)
    - [ ] Without `--force`, the command continues to require `status=failed` (preserves current behavior)
    - [ ] If task has a merged PR (`PR.Status == PRStatusMerged` or `PR.Merged == true`), command auto-detects and reports this
    - [ ] If task has no PR or PR is not merged, command warns user about potential incomplete work
    - [ ] Resolution metadata includes `force_resolved=true` when `--force` is used on non-failed tasks
    - [ ] Resolution metadata includes `pr_was_merged=true` if PR was merged at resolution time
    - [ ] Command output clearly indicates the action taken (resolved, PR merge status)

    ## Testing Requirements

    - [ ] Unit test: `TestResolveCommand_ForceOnRunningTask` - verifies --force works on running tasks
    - [ ] Unit test: `TestResolveCommand_ForceOnPausedTask` - verifies --force works on paused tasks
    - [ ] Unit test: `TestResolveCommand_ForceOnBlockedTask` - verifies --force works on blocked tasks (overrides the helpful error)
    - [ ] Unit test: `TestResolveCommand_ForceOnCreatedTask` - verifies --force works on created tasks
    - [ ] Unit test: `TestResolveCommand_ForceWithMergedPR` - verifies merged PR detection and metadata
    - [ ] Unit test: `TestResolveCommand_ForceWithoutPR` - verifies warning when no PR exists
    - [ ] Unit test: `TestResolveCommand_ForceWithOpenPR` - verifies warning when PR exists but not merged
    - [ ] Unit test: `TestResolveCommand_WithoutForceStillRequiresFailed` - confirms non-force behavior unchanged

    ## Scope

    ### In Scope
    - Adding `--force` flag behavior to bypass status check in `orc resolve`
    - Detecting PR merge status from task.PR field
    - Adding appropriate warnings for potential incomplete work
    - Adding resolution metadata to track force-resolved tasks
    - Updating help text to document new behavior

    ### Out of Scope
    - Fetching live PR status from GitHub (use cached task.PR data)
    - Automatic worktree cleanup (existing `--cleanup` flag handles this)
    - Adding new task statuses (use existing `StatusCompleted` with metadata)
    - Changing the confirmation prompt behavior (still skippable with `-f`)

    ## Technical Approach

    The implementation extends the existing `orc resolve` command to accept `--force` for non-failed tasks.

    ### Files to Modify

    - `internal/cli/cmd_resolve.go`:
      - Modify status check (lines 154-166) to allow any status when `--force` is set
      - Add PR merge detection before status update
      - Add warnings for missing/unmerged PR when force-resolving
      - Add metadata tracking (`force_resolved`, `pr_was_merged`, `original_status`)
      - Update help text to document `--force` on non-failed tasks

    - `internal/cli/cmd_resolve_test.go`:
      - Add test cases for force-resolving running/paused/blocked/created tasks
      - Add test cases for PR merge detection
      - Add test case to verify non-force behavior is unchanged

    ## Bug Analysis

    ### Reproduction Steps
    1. Run `orc run TASK-XXX`
    2. Task creates PR and PR gets merged
    3. Executor crashes or loses connection after merge but before marking task complete
    4. Task is stuck in `status=running` with merged PR
    5. Run `orc resolve TASK-XXX` - fails with "task is running, not failed"
    6. Only workaround is direct SQLite update

    ### Current Behavior
    ```
    $ orc resolve TASK-201
    Error: task TASK-201 is running, not failed; resolve is only for failed tasks
    ```

    ### Expected Behavior
    ```
    $ orc resolve TASK-201 --force
    PR merged (PR #123)
    Task TASK-201 marked as resolved (was: running)

    $ orc resolve TASK-202 --force  # task with no PR
    Warning: No PR found for this task. Work may be incomplete.
    Task TASK-202 marked as resolved (was: running)

    $ orc resolve TASK-203 --force  # task with open PR
    Warning: PR #45 is not merged (status: pending_review). Work may be incomplete.
    Task TASK-203 marked as resolved (was: running)
    ```

    ### Root Cause
    The status check at `cmd_resolve.go:154` explicitly rejects all non-failed tasks:
    ```go
    if t.Status != task.StatusFailed {
        // ... only allows failed tasks
        return fmt.Errorf("task %s is %s, not failed; resolve is only for failed tasks", id, t.Status)
    }
    ```

    ### Verification
    After the fix:
    1. Create a task with `orc new "test"`
    2. Set it to running manually or via `orc run`
    3. Run `orc resolve TASK-XXX --force`
    4. Verify task status is `completed` with metadata `force_resolved=true`
    5. Verify original behavior still works: `orc resolve TASK-YYY` on non-failed task without `--force` still fails
state:
    task_id: TASK-220
    current_phase: docs
    current_iteration: 0
    status: completed
    started_at: 2026-01-16T15:35:19-06:00
    updated_at: 0001-01-01T00:00:00Z
    phases:
        docs:
            status: completed
            started_at: 2026-01-16T15:55:23-06:00
            completed_at: 2026-01-16T15:57:42-06:00
            iterations: 1
            commit_sha: 09c32a9a437ee5cac395c08e9953792787453fcd
            tokens:
                input_tokens: 902949
                output_tokens: 5965
                total_tokens: 0
        implement:
            status: completed
            started_at: 2026-01-16T15:39:50-06:00
            completed_at: 2026-01-16T15:53:15-06:00
            iterations: 1
            commit_sha: e281ef54572dc52da8fc96105112a5189843ad57
            tokens:
                input_tokens: 3041963
                output_tokens: 18770
                total_tokens: 0
        spec:
            status: completed
            started_at: 2026-01-16T15:35:21-06:00
            completed_at: 2026-01-16T15:39:50-06:00
            iterations: 1
            commit_sha: eeeae598fdb7144abbf0b8a90703ee160ad5ddb3
            tokens:
                input_tokens: 2081386
                output_tokens: 8435
                total_tokens: 0
        test:
            status: completed
            started_at: 2026-01-16T15:53:15-06:00
            completed_at: 2026-01-16T15:55:23-06:00
            iterations: 1
            commit_sha: 0ee10fb0c3ed9f2829cbe47c4296a002ae09efce
            tokens:
                input_tokens: 904374
                output_tokens: 3913
                total_tokens: 0
    gates:
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: spec
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:39:50-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: implement
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:53:15-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: test
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:55:23-06:00
        - phase: docs
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:57:42-06:00
        - phase: docs
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:57:42-06:00
        - phase: docs
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:57:42-06:00
        - phase: docs
          gate_type: auto
          approved: true
          reason: auto-approved on success
          timestamp: 2026-01-16T15:57:42-06:00
    tokens:
        input_tokens: 0
        output_tokens: 0
        total_tokens: 0
    cost:
        total_cost_usd: 0
transcripts:
    - id: 71
      taskid: TASK-220
      phase: docs
      iteration: 1
      role: combined
      content: |
        # docs - Iteration 1

        ## Prompt

        Update documentation for:

        **Task**: CLI: orc resolve should support --force for stuck running tasks
        **Category**: bug

        ## Specification

        # Specification: CLI: orc resolve should support --force for stuck running tasks

        ## Problem Statement

        When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks, requiring direct database updates for stuck running tasks.

        ## Success Criteria

        - [ ] `orc resolve TASK-XXX --force` works on tasks with any status (running, paused, blocked, created, planned, etc.)
        - [ ] Without `--force`, the command continues to require `status=failed` (preserves current behavior)
        - [ ] If task has a merged PR (`PR.Status == PRStatusMerged` or `PR.Merged == true`), command auto-detects and reports this
        - [ ] If task has no PR or PR is not merged, command warns user about potential incomplete work
        - [ ] Resolution metadata includes `force_resolved=true` when `--force` is used on non-failed tasks
        - [ ] Resolution metadata includes `pr_was_merged=true` if PR was merged at resolution time
        - [ ] Command output clearly indicates the action taken (resolved, PR merge status)

        ## Testing Requirements

        - [ ] Unit test: `TestResolveCommand_ForceOnRunningTask` - verifies --force works on running tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnPausedTask` - verifies --force works on paused tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnBlockedTask` - verifies --force works on blocked tasks (overrides the helpful error)
        - [ ] Unit test: `TestResolveCommand_ForceOnCreatedTask` - verifies --force works on created tasks
        - [ ] Unit test: `TestResolveCommand_ForceWithMergedPR` - verifies merged PR detection and metadata
        - [ ] Unit test: `TestResolveCommand_ForceWithoutPR` - verifies warning when no PR exists
        - [ ] Unit test: `TestResolveCommand_ForceWithOpenPR` - verifies warning when PR exists but not merged
        - [ ] Unit test: `TestResolveCommand_WithoutForceStillRequiresFailed` - confirms non-force behavior unchanged

        ## Scope

        ### In Scope
        - Adding `--force` flag behavior to bypass status check in `orc resolve`
        - Detecting PR merge status from task.PR field
        - Adding appropriate warnings for potential incomplete work
        - Adding resolution metadata to track force-resolved tasks
        - Updating help text to document new behavior

        ### Out of Scope
        - Fetching live PR status from GitHub (use cached task.PR data)
        - Automatic worktree cleanup (existing `--cleanup` flag handles this)
        - Adding new task statuses (use existing `StatusCompleted` with metadata)
        - Changing the confirmation prompt behavior (still skippable with `-f`)

        ## Technical Approach

        The implementation extends the existing `orc resolve` command to accept `--force` for non-failed tasks.

        ### Files to Modify

        - `internal/cli/cmd_resolve.go`:
          - Modify status check (lines 154-166) to allow any status when `--force` is set
          - Add PR merge detection before status update
          - Add warnings for missing/unmerged PR when force-resolving
          - Add metadata tracking (`force_resolved`, `pr_was_merged`, `original_status`)
          - Update help text to document `--force` on non-failed tasks

        - `internal/cli/cmd_resolve_test.go`:
          - Add test cases for force-resolving running/paused/blocked/created tasks
          - Add test cases for PR merge detection
          - Add test case to verify non-force behavior is unchanged

        ## Bug Analysis

        ### Reproduction Steps
        1. Run `orc run TASK-XXX`
        2. Task creates PR and PR gets merged
        3. Executor crashes or loses connection after merge but before marking task complete
        4. Task is stuck in `status=running` with merged PR
        5. Run `orc resolve TASK-XXX` - fails with "task is running, not failed"
        6. Only workaround is direct SQLite update

        ### Current Behavior
        ```
        $ orc resolve TASK-201
        Error: task TASK-201 is running, not failed; resolve is only for failed tasks
        ```

        ### Expected Behavior
        ```
        $ orc resolve TASK-201 --force
        PR merged (PR #123)
        Task TASK-201 marked as resolved (was: running)

        $ orc resolve TASK-202 --force  # task with no PR
        Warning: No PR found for this task. Work may be incomplete.
        Task TASK-202 marked as resolved (was: running)

        $ orc resolve TASK-203 --force  # task with open PR
        Warning: PR #45 is not merged (status: pending_review). Work may be incomplete.
        Task TASK-203 marked as resolved (was: running)
        ```

        ### Root Cause
        The status check at `cmd_resolve.go:154` explicitly rejects all non-failed tasks:
        ```go
        if t.Status != task.StatusFailed {
            // ... only allows failed tasks
            return fmt.Errorf("task %s is %s, not failed; resolve is only for failed tasks", id, t.Status)
        }
        ```

        ### Verification
        After the fix:
        1. Create a task with `orc new "test"`
        2. Set it to running manually or via `orc run`
        3. Run `orc resolve TASK-XXX --force`
        4. Verify task status is `completed` with metadata `force_resolved=true`
        5. Verify original behavior still works: `orc resolve TASK-YYY` on non-failed task without `--force` still fails

        ## Instructions

        1. Update any relevant documentation files
        2. Ensure CLAUDE.md reflects the changes if applicable
        3. Add/update code comments where needed
        4. Update README if user-facing changes were made

        Keep iterating until documentation is complete.

        After completing, commit:
        ```bash
        git add -A
        git commit -m "[orc] TASK-220: docs - completed"
        ```

        When done, output:
        ```
        **Commit**: [SHA]
        <phase_complete>true</phase_complete>
        ```


        ## Response

        **Commit**: bff05d42
        <phase_complete>true</phase_complete>

        ---
        Tokens: 902949 input, 5965 output, 55856 cache_creation, 844361 cache_read
        Complete: true
        Blocked: false
      timestamp: 1768661764
    - id: 72
      taskid: TASK-220
      phase: implement
      iteration: 1
      role: combined
      content: |
        # implement - Iteration 1

        ## Prompt

        Implement the task according to the specification:

        **Task**: CLI: orc resolve should support --force for stuck running tasks
        **Category**: bug



        ## Specification

        # Specification: CLI: orc resolve should support --force for stuck running tasks

        ## Problem Statement

        When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks, requiring direct database updates for stuck running tasks.

        ## Success Criteria

        - [ ] `orc resolve TASK-XXX --force` works on tasks with any status (running, paused, blocked, created, planned, etc.)
        - [ ] Without `--force`, the command continues to require `status=failed` (preserves current behavior)
        - [ ] If task has a merged PR (`PR.Status == PRStatusMerged` or `PR.Merged == true`), command auto-detects and reports this
        - [ ] If task has no PR or PR is not merged, command warns user about potential incomplete work
        - [ ] Resolution metadata includes `force_resolved=true` when `--force` is used on non-failed tasks
        - [ ] Resolution metadata includes `pr_was_merged=true` if PR was merged at resolution time
        - [ ] Command output clearly indicates the action taken (resolved, PR merge status)

        ## Testing Requirements

        - [ ] Unit test: `TestResolveCommand_ForceOnRunningTask` - verifies --force works on running tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnPausedTask` - verifies --force works on paused tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnBlockedTask` - verifies --force works on blocked tasks (overrides the helpful error)
        - [ ] Unit test: `TestResolveCommand_ForceOnCreatedTask` - verifies --force works on created tasks
        - [ ] Unit test: `TestResolveCommand_ForceWithMergedPR` - verifies merged PR detection and metadata
        - [ ] Unit test: `TestResolveCommand_ForceWithoutPR` - verifies warning when no PR exists
        - [ ] Unit test: `TestResolveCommand_ForceWithOpenPR` - verifies warning when PR exists but not merged
        - [ ] Unit test: `TestResolveCommand_WithoutForceStillRequiresFailed` - confirms non-force behavior unchanged

        ## Scope

        ### In Scope
        - Adding `--force` flag behavior to bypass status check in `orc resolve`
        - Detecting PR merge status from task.PR field
        - Adding appropriate warnings for potential incomplete work
        - Adding resolution metadata to track force-resolved tasks
        - Updating help text to document new behavior

        ### Out of Scope
        - Fetching live PR status from GitHub (use cached task.PR data)
        - Automatic worktree cleanup (existing `--cleanup` flag handles this)
        - Adding new task statuses (use existing `StatusCompleted` with metadata)
        - Changing the confirmation prompt behavior (still skippable with `-f`)

        ## Technical Approach

        The implementation extends the existing `orc resolve` command to accept `--force` for non-failed tasks.

        ### Files to Modify

        - `internal/cli/cmd_resolve.go`:
          - Modify status check (lines 154-166) to allow any status when `--force` is set
          - Add PR merge detection before status update
          - Add warnings for missing/unmerged PR when force-resolving
          - Add metadata tracking (`force_resolved`, `pr_was_merged`, `original_status`)
          - Update help text to document `--force` on non-failed tasks

        - `internal/cli/cmd_resolve_test.go`:
          - Add test cases for force-resolving running/paused/blocked/created tasks
          - Add test cases for PR merge detection
          - Add test case to verify non-force behavior is unchanged

        ## Bug Analysis

        ### Reproduction Steps
        1. Run `orc run TASK-XXX`
        2. Task creates PR and PR gets merged
        3. Executor crashes or loses connection after merge but before marking task complete
        4. Task is stuck in `status=running` with merged PR
        5. Run `orc resolve TASK-XXX` - fails with "task is running, not failed"
        6. Only workaround is direct SQLite update

        ### Current Behavior
        ```
        $ orc resolve TASK-201
        Error: task TASK-201 is running, not failed; resolve is only for failed tasks
        ```

        ### Expected Behavior
        ```
        $ orc resolve TASK-201 --force
        PR merged (PR #123)
        Task TASK-201 marked as resolved (was: running)

        $ orc resolve TASK-202 --force  # task with no PR
        Warning: No PR found for this task. Work may be incomplete.
        Task TASK-202 marked as resolved (was: running)

        $ orc resolve TASK-203 --force  # task with open PR
        Warning: PR #45 is not merged (status: pending_review). Work may be incomplete.
        Task TASK-203 marked as resolved (was: running)
        ```

        ### Root Cause
        The status check at `cmd_resolve.go:154` explicitly rejects all non-failed tasks:
        ```go
        if t.Status != task.StatusFailed {
            // ... only allows failed tasks
            return fmt.Errorf("task %s is %s, not failed; resolve is only for failed tasks", id, t.Status)
        }
        ```

        ### Verification
        After the fix:
        1. Create a task with `orc new "test"`
        2. Set it to running manually or via `orc run`
        3. Run `orc resolve TASK-XXX --force`
        4. Verify task status is `completed` with metadata `force_resolved=true`
        5. Verify original behavior still works: `orc resolve TASK-YYY` on non-failed task without `--force` still fails



        ## Instructions

        1. Review the spec's success criteria - these are your acceptance criteria
        2. Implement the required changes following the technical approach
        3. Write/update tests alongside code (as specified in Testing Requirements)
        4. Run tests and fix any failures
        5. Self-review against success criteria before completing

        ### Self-Review Checklist
        - [ ] All success criteria from spec addressed
        - [ ] All testing requirements satisfied
        - [ ] Scope boundaries respected (no extra features)
        - [ ] Error handling complete
        - [ ] Code follows project patterns

        Keep iterating until implementation is complete and tests pass.

        After completing, commit:
        ```bash
        git add -A
        git commit -m "[orc] TASK-220: implement - completed"
        ```

        When done, output:
        ```
        **Commit**: [SHA]
        <phase_complete>true</phase_complete>
        ```


        ## Response

        **Commit**: e53346be

        <phase_complete>true</phase_complete>

        ---
        Tokens: 3041963 input, 18770 output, 164712 cache_creation, 2877168 cache_read
        Complete: true
        Blocked: false
      timestamp: 1768661764
    - id: 73
      taskid: TASK-220
      phase: spec
      iteration: 1
      role: combined
      content: |
        # spec - Iteration 1

        ## Prompt

        Create a specification for this task:

        **Task**: CLI: orc resolve should support --force for stuck running tasks
        **Category**: bug
        **Description**: ## Problem
        When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks.

        ## Friction Encountered
        - TASK-179: stuck in running, PR merged, had to use direct DB update
        - TASK-201: stuck in running, PR merged, had to use direct DB update

        ## Proposed Solution
        Add `--force` flag to `orc resolve` that:
        1. Works on any status (not just failed)
        2. Checks if PR exists and is merged (auto-detect completion)
        3. Sets status to 'finished' if PR merged, 'completed' otherwise

        ## Example
        ```bash
        orc resolve TASK-201 --force  # Works even though status is 'running'
        orc resolve TASK-201 --force --message 'PR merged manually'
        ```

        ## Acceptance Criteria
        - `orc resolve --force` works on running/paused/blocked tasks
        - If task has merged PR, auto-sets to 'finished'
        - Warns user if no PR exists (might be incomplete work)
        - Updates phases to completed state



        ## Instructions

        Create a clear, actionable specification that defines exactly what needs to be done
        and how to verify it's complete.

        ### 1. Problem Statement
        Summarize what needs to be solved in 1-2 sentences.

        ### 2. Success Criteria (REQUIRED)
        Define specific, testable criteria as checkboxes:
        - Each criterion must be verifiable (file exists, test passes, API returns X)
        - No vague language ("works well", "is fast")
        - Include both functional and quality criteria

        ### 3. Testing Requirements (REQUIRED)
        Specify what tests must pass:
        - [ ] Unit test: [specific test description]
        - [ ] Integration test: [if applicable]
        - [ ] E2E test: [if UI changes]

        ### 4. Scope
        Define boundaries to prevent scope creep:
        - **In Scope**: What will be implemented
        - **Out of Scope**: What will NOT be implemented

        ### 5. Technical Approach
        Brief plan for implementation:
        - Files to modify
        - Key changes in each file

        ### 6. Category-Specific Analysis

        **If this is a BUG (category=bug):**
        - Reproduction Steps: Exact steps to trigger the bug
        - Current Behavior: What happens now (the bug)
        - Expected Behavior: What should happen
        - Root Cause: Where the bug originates (if known)
        - Verification: How to confirm the fix works

        **If this is a FEATURE (category=feature):**
        - User Story: As a [user], I want [feature] so that [benefit]
        - Acceptance Criteria: Specific conditions for feature acceptance

        **If this is a REFACTOR (category=refactor):**
        - Before Pattern: Current code/architecture
        - After Pattern: Target code/architecture
        - Risk Assessment: What could break

        ## Output Format

        Wrap your spec in artifact tags:

        <artifact>
        # Specification: CLI: orc resolve should support --force for stuck running tasks

        ## Problem Statement
        [1-2 sentences]

        ## Success Criteria
        - [ ] [Criterion 1]
        - [ ] [Criterion 2]

        ## Testing Requirements
        - [ ] [Test 1]
        - [ ] [Test 2]

        ## Scope
        ### In Scope
        - [Item]
        ### Out of Scope
        - [Item]

        ## Technical Approach
        [Brief implementation plan]

        ### Files to Modify
        - [file]: [change]

        ## [Category-Specific Section]
        [Include appropriate section based on category]
        </artifact>

        After completing the spec, commit:
        ```bash
        git add -A
        git commit -m "[orc] TASK-220: spec - completed"
        ```

        Then output:
        ```
        **Commit**: [SHA]
        <phase_complete>true</phase_complete>
        ```

        If blocked (requirements unclear):
        ```
        <phase_blocked>
        reason: [what's unclear]
        needs: [what clarification is needed]
        </phase_blocked>
        ```


        ## Response

        <artifact>
        # Specification: CLI: orc resolve should support --force for stuck running tasks

        ## Problem Statement

        When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks, requiring direct database updates for stuck running tasks.

        ## Success Criteria

        - [ ] `orc resolve TASK-XXX --force` works on tasks with any status (running, paused, blocked, created, planned, etc.)
        - [ ] Without `--force`, the command continues to require `status=failed` (preserves current behavior)
        - [ ] If task has a merged PR (`PR.Status == PRStatusMerged` or `PR.Merged == true`), command auto-detects and reports this
        - [ ] If task has no PR or PR is not merged, command warns user about potential incomplete work
        - [ ] Resolution metadata includes `force_resolved=true` when `--force` is used on non-failed tasks
        - [ ] Resolution metadata includes `pr_was_merged=true` if PR was merged at resolution time
        - [ ] Command output clearly indicates the action taken (resolved, PR merge status)

        ## Testing Requirements

        - [ ] Unit test: `TestResolveCommand_ForceOnRunningTask` - verifies --force works on running tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnPausedTask` - verifies --force works on paused tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnBlockedTask` - verifies --force works on blocked tasks (overrides the helpful error)
        - [ ] Unit test: `TestResolveCommand_ForceOnCreatedTask` - verifies --force works on created tasks
        - [ ] Unit test: `TestResolveCommand_ForceWithMergedPR` - verifies merged PR detection and metadata
        - [ ] Unit test: `TestResolveCommand_ForceWithoutPR` - verifies warning when no PR exists
        - [ ] Unit test: `TestResolveCommand_ForceWithOpenPR` - verifies warning when PR exists but not merged
        - [ ] Unit test: `TestResolveCommand_WithoutForceStillRequiresFailed` - confirms non-force behavior unchanged

        ## Scope

        ### In Scope
        - Adding `--force` flag behavior to bypass status check in `orc resolve`
        - Detecting PR merge status from task.PR field
        - Adding appropriate warnings for potential incomplete work
        - Adding resolution metadata to track force-resolved tasks
        - Updating help text to document new behavior

        ### Out of Scope
        - Fetching live PR status from GitHub (use cached task.PR data)
        - Automatic worktree cleanup (existing `--cleanup` flag handles this)
        - Adding new task statuses (use existing `StatusCompleted` with metadata)
        - Changing the confirmation prompt behavior (still skippable with `-f`)

        ## Technical Approach

        The implementation extends the existing `orc resolve` command to accept `--force` for non-failed tasks.

        ### Files to Modify

        - `internal/cli/cmd_resolve.go`:
          - Modify status check (lines 154-166) to allow any status when `--force` is set
          - Add PR merge detection before status update
          - Add warnings for missing/unmerged PR when force-resolving
          - Add metadata tracking (`force_resolved`, `pr_was_merged`, `original_status`)
          - Update help text to document `--force` on non-failed tasks

        - `internal/cli/cmd_resolve_test.go`:
          - Add test cases for force-resolving running/paused/blocked/created tasks
          - Add test cases for PR merge detection
          - Add test case to verify non-force behavior is unchanged

        ## Bug Analysis

        ### Reproduction Steps
        1. Run `orc run TASK-XXX`
        2. Task creates PR and PR gets merged
        3. Executor crashes or loses connection after merge but before marking task complete
        4. Task is stuck in `status=running` with merged PR
        5. Run `orc resolve TASK-XXX` - fails with "task is running, not failed"
        6. Only workaround is direct SQLite update

        ### Current Behavior
        ```
        $ orc resolve TASK-201
        Error: task TASK-201 is running, not failed; resolve is only for failed tasks
        ```

        ### Expected Behavior
        ```
        $ orc resolve TASK-201 --force
        PR merged (PR #123)
        Task TASK-201 marked as resolved (was: running)

        $ orc resolve TASK-202 --force  # task with no PR
        Warning: No PR found for this task. Work may be incomplete.
        Task TASK-202 marked as resolved (was: running)

        $ orc resolve TASK-203 --force  # task with open PR
        Warning: PR #45 is not merged (status: pending_review). Work may be incomplete.
        Task TASK-203 marked as resolved (was: running)
        ```

        ### Root Cause
        The status check at `cmd_resolve.go:154` explicitly rejects all non-failed tasks:
        ```go
        if t.Status != task.StatusFailed {
            // ... only allows failed tasks
            return fmt.Errorf("task %s is %s, not failed; resolve is only for failed tasks", id, t.Status)
        }
        ```

        ### Verification
        After the fix:
        1. Create a task with `orc new "test"`
        2. Set it to running manually or via `orc run`
        3. Run `orc resolve TASK-XXX --force`
        4. Verify task status is `completed` with metadata `force_resolved=true`
        5. Verify original behavior still works: `orc resolve TASK-YYY` on non-failed task without `--force` still fails
        </artifact>

        **Commit**: 6e4658be
        <phase_complete>true</phase_complete>

        ---
        Tokens: 2081386 input, 8435 output, 74784 cache_creation, 2006567 cache_read
        Complete: true
        Blocked: false
      timestamp: 1768661764
    - id: 74
      taskid: TASK-220
      phase: test
      iteration: 1
      role: combined
      content: |
        # test - Iteration 1

        ## Prompt

        Test and review the implementation:

        **Task**: CLI: orc resolve should support --force for stuck running tasks
        **Category**: bug

        ## Specification

        # Specification: CLI: orc resolve should support --force for stuck running tasks

        ## Problem Statement

        When a task is stuck in 'running' status but has a merged PR (e.g., executor crashed after merge), there's no CLI way to mark it complete. Currently `orc resolve` only works on failed tasks, requiring direct database updates for stuck running tasks.

        ## Success Criteria

        - [ ] `orc resolve TASK-XXX --force` works on tasks with any status (running, paused, blocked, created, planned, etc.)
        - [ ] Without `--force`, the command continues to require `status=failed` (preserves current behavior)
        - [ ] If task has a merged PR (`PR.Status == PRStatusMerged` or `PR.Merged == true`), command auto-detects and reports this
        - [ ] If task has no PR or PR is not merged, command warns user about potential incomplete work
        - [ ] Resolution metadata includes `force_resolved=true` when `--force` is used on non-failed tasks
        - [ ] Resolution metadata includes `pr_was_merged=true` if PR was merged at resolution time
        - [ ] Command output clearly indicates the action taken (resolved, PR merge status)

        ## Testing Requirements

        - [ ] Unit test: `TestResolveCommand_ForceOnRunningTask` - verifies --force works on running tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnPausedTask` - verifies --force works on paused tasks
        - [ ] Unit test: `TestResolveCommand_ForceOnBlockedTask` - verifies --force works on blocked tasks (overrides the helpful error)
        - [ ] Unit test: `TestResolveCommand_ForceOnCreatedTask` - verifies --force works on created tasks
        - [ ] Unit test: `TestResolveCommand_ForceWithMergedPR` - verifies merged PR detection and metadata
        - [ ] Unit test: `TestResolveCommand_ForceWithoutPR` - verifies warning when no PR exists
        - [ ] Unit test: `TestResolveCommand_ForceWithOpenPR` - verifies warning when PR exists but not merged
        - [ ] Unit test: `TestResolveCommand_WithoutForceStillRequiresFailed` - confirms non-force behavior unchanged

        ## Scope

        ### In Scope
        - Adding `--force` flag behavior to bypass status check in `orc resolve`
        - Detecting PR merge status from task.PR field
        - Adding appropriate warnings for potential incomplete work
        - Adding resolution metadata to track force-resolved tasks
        - Updating help text to document new behavior

        ### Out of Scope
        - Fetching live PR status from GitHub (use cached task.PR data)
        - Automatic worktree cleanup (existing `--cleanup` flag handles this)
        - Adding new task statuses (use existing `StatusCompleted` with metadata)
        - Changing the confirmation prompt behavior (still skippable with `-f`)

        ## Technical Approach

        The implementation extends the existing `orc resolve` command to accept `--force` for non-failed tasks.

        ### Files to Modify

        - `internal/cli/cmd_resolve.go`:
          - Modify status check (lines 154-166) to allow any status when `--force` is set
          - Add PR merge detection before status update
          - Add warnings for missing/unmerged PR when force-resolving
          - Add metadata tracking (`force_resolved`, `pr_was_merged`, `original_status`)
          - Update help text to document `--force` on non-failed tasks

        - `internal/cli/cmd_resolve_test.go`:
          - Add test cases for force-resolving running/paused/blocked/created tasks
          - Add test cases for PR merge detection
          - Add test case to verify non-force behavior is unchanged

        ## Bug Analysis

        ### Reproduction Steps
        1. Run `orc run TASK-XXX`
        2. Task creates PR and PR gets merged
        3. Executor crashes or loses connection after merge but before marking task complete
        4. Task is stuck in `status=running` with merged PR
        5. Run `orc resolve TASK-XXX` - fails with "task is running, not failed"
        6. Only workaround is direct SQLite update

        ### Current Behavior
        ```
        $ orc resolve TASK-201
        Error: task TASK-201 is running, not failed; resolve is only for failed tasks
        ```

        ### Expected Behavior
        ```
        $ orc resolve TASK-201 --force
        PR merged (PR #123)
        Task TASK-201 marked as resolved (was: running)

        $ orc resolve TASK-202 --force  # task with no PR
        Warning: No PR found for this task. Work may be incomplete.
        Task TASK-202 marked as resolved (was: running)

        $ orc resolve TASK-203 --force  # task with open PR
        Warning: PR #45 is not merged (status: pending_review). Work may be incomplete.
        Task TASK-203 marked as resolved (was: running)
        ```

        ### Root Cause
        The status check at `cmd_resolve.go:154` explicitly rejects all non-failed tasks:
        ```go
        if t.Status != task.StatusFailed {
            // ... only allows failed tasks
            return fmt.Errorf("task %s is %s, not failed; resolve is only for failed tasks", id, t.Status)
        }
        ```

        ### Verification
        After the fix:
        1. Create a task with `orc new "test"`
        2. Set it to running manually or via `orc run`
        3. Run `orc resolve TASK-XXX --force`
        4. Verify task status is `completed` with metadata `force_resolved=true`
        5. Verify original behavior still works: `orc resolve TASK-YYY` on non-failed task without `--force` still fails

        ## Instructions

        1. Run the full test suite
        2. Verify all Testing Requirements from spec are satisfied
        3. Review code for quality issues
        4. Check for edge cases and security issues
        5. Fix any problems found

        ### Verification Against Spec
        Go through each Success Criterion and Testing Requirement from the spec
        and verify it's satisfied.

        Keep iterating until all tests pass and code quality is acceptable.

        After completing, commit:
        ```bash
        git add -A
        git commit -m "[orc] TASK-220: test - completed"
        ```

        When done, output:
        ```
        **Commit**: [SHA]
        <phase_complete>true</phase_complete>
        ```


        ## Response

        **Commit**: e281ef54
        <phase_complete>true</phase_complete>

        ---
        Tokens: 904374 input, 3913 output, 57965 cache_creation, 846392 cache_read
        Complete: true
        Blocked: false
      timestamp: 1768661764
gate_decisions:
    - id: 219453
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219454
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219455
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219456
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219457
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219458
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219459
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219460
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219461
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219462
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219463
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219464
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219465
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219466
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219485
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219486
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219487
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219488
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219489
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219490
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219491
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219492
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219493
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219494
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219495
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219496
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219497
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219498
      taskid: TASK-220
      phase: spec
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:39:50-06:00
    - id: 219467
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219468
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219469
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219470
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219471
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219472
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219473
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219474
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219475
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219476
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219499
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219500
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219501
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219502
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219503
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219504
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219505
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219506
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219507
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219508
      taskid: TASK-220
      phase: implement
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:53:15-06:00
    - id: 219477
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219478
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219479
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219480
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219481
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219482
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219509
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219510
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219511
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219512
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219513
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219514
      taskid: TASK-220
      phase: test
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:55:23-06:00
    - id: 219483
      taskid: TASK-220
      phase: docs
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:57:42-06:00
    - id: 219484
      taskid: TASK-220
      phase: docs
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:57:42-06:00
    - id: 219515
      taskid: TASK-220
      phase: docs
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:57:42-06:00
    - id: 219516
      taskid: TASK-220
      phase: docs
      gatetype: auto
      approved: true
      reason: auto-approved on success
      decidedby: ""
      decidedat: 2026-01-16T15:57:42-06:00
