id: TASK-165
title: 'Phase 1: Create useWebSocket hook and WebSocketProvider'
description: |-
    ## Purpose
    Port the WebSocket client to React with proper hook-based API.

    ## Implementation

    ### WebSocket Client (port from websocket.ts)
    - OrcWebSocket class (keep similar structure)
    - Connection lifecycle: connect, reconnect, disconnect
    - Subscription model: global (*) vs task-specific
    - Auto-reconnect with exponential backoff
    - Ping/pong heartbeat (30s interval)
    - Primary subscription restoration on reconnect

    ### React Integration

    #### WebSocketProvider
    - Context provider wrapping app
    - Manages single WebSocket instance
    - Exposes connection status

    #### useWebSocket hook
    ```typescript
    const { status, subscribe, unsubscribe } = useWebSocket()
    ```

    #### useTaskSubscription hook
    ```typescript
    const { state, transcript } = useTaskSubscription('TASK-001')
    ```

    ### Event Handling
    - state -> update TaskStore
    - transcript -> streaming to component
    - task_created/updated/deleted -> update TaskStore
    - error -> toast notification

    ## Success Criteria
    - WebSocket connects and reconnects correctly
    - Events update stores in real-time
    - Connection status visible in UI
    - No memory leaks on unmount
weight: medium
status: completed
current_phase: implement
branch: orc/TASK-165
queue: active
priority: normal
category: feature
initiative_id: INIT-005
blocked_by:
    - TASK-163
requires_ui_testing: true
testing_requirements:
    unit: true
created_at: 2026-01-14T02:20:25.354239924-06:00
updated_at: 2026-01-14T11:24:54.314821-06:00
started_at: 2026-01-14T11:24:53.975362-06:00
