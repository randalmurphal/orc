id: TASK-196
title: 'Fix: Auto-merge fails when main branch is checked out locally'
description: |-
    ## Problem
    When a task completes and tries to auto-merge, it fails if main is checked out in the main repo:

    ```
    gh pr merge: exit status 1: failed to run git: fatal: 'main' is already used by worktree at '/home/randy/repos/orc'
    ```

    This is the common case - users typically have main checked out when running orc.

    ## Root Cause
    The `gh pr merge` command tries to checkout main locally to fast-forward it, but can't because it's already in use.

    ## Solutions to Investigate
    1. Use `gh pr merge --merge` with `--admin` flag to bypass local checkout
    2. Temporarily switch main repo to a detached HEAD or temp branch
    3. Use GitHub API directly instead of gh CLI
    4. Accept the limitation and just skip auto-merge when main is checked out (document it)

    ## Success Criteria
    `orc run TASK-XXX` with auto-merge enabled works when main is checked out locally
weight: medium
status: running
current_phase: spec
branch: orc/TASK-196
queue: active
priority: high
category: bug
testing_requirements:
    unit: true
created_at: 2026-01-14T19:55:55.435064654-06:00
updated_at: 2026-01-14T19:56:14.427321372-06:00
started_at: 2026-01-14T19:56:13.240179115-06:00
