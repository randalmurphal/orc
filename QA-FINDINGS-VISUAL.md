# Visual Findings Summary - Statistics Page

## Screenshot Analysis: `web/e2e/__snapshots__/stats.spec.ts-snapshots/stats-page-full.png`

### Issues Identified in Screenshot

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Statistics                        24h  7d  30d  All    Export  â”‚ â† QA-002: Buttons too small
â”‚  Token usage, costs, and task metrics                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”   â”‚
â”‚  â”‚Tasks     â”‚ â”‚Tokens    â”‚ â”‚Total     â”‚ â”‚Avg Task  â”‚ â”‚Suc â”‚   â”‚
â”‚  â”‚Completed â”‚ â”‚Used      â”‚ â”‚Cost      â”‚ â”‚Time      â”‚ â”‚Rat â”‚   â”‚
â”‚  â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚    â”‚   â”‚
â”‚  â”‚   88     â”‚ â”‚  83.5M   â”‚ â”‚$483.02   â”‚ â”‚ 416:08   â”‚ â”‚96% â”‚   â”‚
â”‚  â”‚ â†“ 49%    â”‚ â”‚ â†“ 94%    â”‚ â”‚No change â”‚ â”‚No change â”‚ â”‚â†“3% â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Task Activity                              Less â–“â–“â–“â–“ More     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚     Oct        Nov           Dec              Jan           â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚Mon                                                           â”‚â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”                                                    â”‚â”‚
â”‚  â”‚Wed  â”‚â–“â–“â–“â”‚           â”Œâ”€â”€â”€â”                                   â”‚â”‚ â† QA-004: Sparse heatmap
â”‚  â”‚     â””â”€â”€â”€â”˜  â”Œâ”€â”€â”€â”    â”‚â–“â–“â–“â”‚      â”Œâ”€â”€â”€â”                        â”‚â”‚   (only 6-7 cells)
â”‚  â”‚Fri         â”‚â–“â–“â–“â”‚    â””â”€â”€â”€â”˜      â”‚â–“â–“â–“â”‚                        â”‚â”‚
â”‚  â”‚            â””â”€â”€â”€â”˜               â””â”€â”€â”€â”˜                  â”Œâ”€â”€â”€â” â”‚â”‚
â”‚  â”‚                      â”Œâ”€â”€â”€â”                     â”Œâ”€â”€â”€â”  â”‚â–“â–“â–“â”‚ â”‚â”‚
â”‚  â”‚                      â”‚â–“â–“â–“â”‚                     â”‚â–“â–“â–“â”‚  â””â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                      â””â”€â”€â”€â”˜                     â””â”€â”€â”€â”˜        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  [Screenshot cuts off here - cannot verify sections below]      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NOT VISIBLE IN SCREENSHOT (but expected per reference design):
â”œâ”€ Charts Row (2 columns)
â”‚  â”œâ”€ Tasks Completed Per Day (bar chart)
â”‚  â””â”€ Task Outcomes (donut chart)
â”‚
â””â”€ Tables Row (2 columns)
   â”œâ”€ Most Active Initiatives âœ… (implemented)
   â””â”€ Most Modified Files âŒ (QA-003: always empty)
```

## Issue Locations in Screenshot

### ğŸ”´ QA-002: Touch Targets Too Small (Medium, Confidence: 95%)
**Visual Location:** Top right corner of header
- Time filter buttons: `24h`, `7d`, `30d`, `All`
- **Problem:** Buttons appear compact and small
- **Measured (estimated):** ~25px height, ~29px width
- **Required:** 44x44px minimum for mobile
- **File:** `web/src/components/stats/StatsView.css:69`

### ğŸŸ¡ QA-004: Sparse Activity Heatmap (Medium, Confidence: 85%)
**Visual Location:** Middle section, "Task Activity" card
- **Problem:** Only 6-7 isolated cells visible (teal/green squares)
- **Expected:** Dense GitHub-style grid with many cells (see reference design)
- **Possible Causes:**
  1. Test environment has minimal data
  2. Rendering issue (cells not displaying)
  3. Date range calculation error
- **File:** `web/src/components/stats/ActivityHeatmap.tsx`

### âŒ QA-003: Most Modified Files Empty (High, Confidence: 100%)
**Visual Location:** NOT VISIBLE (below screenshot cutoff, expected in bottom-right table)
- **Problem:** `topFiles` is hardcoded to `[]` in statsStore
- **Impact:** Table always shows 0 rows or "No data"
- **Root Cause:** Backend API endpoint not implemented
- **File:** `web/src/stores/statsStore.ts:273`

### â“ QA-001: WebSocket Errors (Status: UNKNOWN)
**Visual Location:** N/A (would appear in browser console)
- **Cannot Verify:** Code inspection shows Stats page doesn't use WebSocket subscription
- **Needs:** Manual testing with browser console open
- **May be:** Obsolete issue (WebSocket replaced with REST) or from different component

---

## Comparison to Reference Design

### Reference Design: `example_ui/statistics-charts.png`

**What Matches âœ…:**
1. Header layout (title, subtitle, filters, export button)
2. 5 metric cards with icons and trend indicators
3. Activity heatmap section with month labels
4. Expected sections present in code (charts, tables)

**What Differs âŒ:**
1. **Heatmap Density:** Reference shows dense grid, screenshot shows sparse cells
2. **Button Size:** Reference buttons appear larger/more prominent
3. **Data Values:** Reference shows positive trends (+23%, +18%), screenshot shows negative trends (all red)
4. **Most Modified Files:** Reference shows 4 files with counts, implementation is empty

**Partial View:**
- Screenshot only shows top ~40% of page
- Cannot verify charts or tables visually
- Code inspection confirms these sections exist in implementation

---

## Testing Matrix

| Component | Code âœ… | Visual âœ… | Interactive âš ï¸ | Status |
|-----------|---------|-----------|----------------|--------|
| Header | âœ… Present | âœ… Visible | âš ï¸ Not tested | OK |
| Time Filters | âœ… Present | âœ… Visible | âš ï¸ Not tested | **QA-002** |
| Export Button | âœ… Present | âœ… Visible | âš ï¸ Not tested | Untested |
| Metrics Cards | âœ… Present | âœ… Visible | N/A | OK |
| Activity Heatmap | âœ… Present | âš ï¸ Sparse | âš ï¸ Not tested | **QA-004** |
| Bar Chart | âœ… Present | âŒ Not visible | âš ï¸ Not tested | Unknown |
| Donut Chart | âœ… Present | âŒ Not visible | âš ï¸ Not tested | Unknown |
| Initiatives Table | âœ… Present | âŒ Not visible | âš ï¸ Not tested | Unknown |
| Files Table | âŒ Empty data | âŒ Not visible | âš ï¸ Not tested | **QA-003** |

**Legend:**
- âœ… = Confirmed working
- âš ï¸ = Needs manual testing
- âŒ = Issue confirmed or not visible

---

## Code-to-Visual Mapping

### Components Rendered (from StatsView.tsx)

```tsx
StatsView
â”œâ”€ Header (line 362-379)
â”‚  â”œâ”€ Title + Subtitle âœ…
â”‚  â”œâ”€ TimeFilter âš ï¸ QA-002 (buttons too small)
â”‚  â””â”€ Export Button âœ…
â”‚
â”œâ”€ Content (line 381-474)
   â”œâ”€ StatsGrid (line 391-429) âœ…
   â”‚  â””â”€ 5 Ã— StatCard âœ…
   â”‚
   â”œâ”€ ActivityHeatmap (line 432-438) âš ï¸ QA-004 (sparse)
   â”‚
   â”œâ”€ ChartsRow (line 441-458) âŒ Not visible in screenshot
   â”‚  â”œâ”€ TasksBarChart â“
   â”‚  â””â”€ OutcomesDonut â“
   â”‚
   â””â”€ TablesRow (line 461-471) âŒ Not visible in screenshot
      â”œâ”€ LeaderboardTable (Initiatives) â“
      â””â”€ LeaderboardTable (Files) âŒ QA-003 (empty data)
```

---

## Recommendations for Next Steps

### 1. Take Full-Page Screenshots â­ HIGH PRIORITY
The current screenshot only shows ~40% of the page. Need full-page captures to verify:
- Bar chart rendering
- Donut chart rendering
- Initiatives table data
- Files table empty state (QA-003 confirmation)

**Action:**
```bash
cd web
bunx playwright test stats.spec.ts --headed
# or
make e2e
```

### 2. Mobile Viewport Testing â­ HIGH PRIORITY
Test on 375x667 viewport to verify QA-002 (touch targets):
- Measure actual button dimensions
- Test tap interactions
- Verify responsive layout doesn't break

**Action:**
```bash
bunx playwright test stats.spec.ts --project=chromium --device="iPhone SE"
```

### 3. Console Monitoring â­ MEDIUM PRIORITY
Check for QA-001 (WebSocket errors):
- Open browser dev tools
- Navigate to `/stats`
- Monitor console for errors
- Check Network tab for failed requests

### 4. Data Verification ğŸ” MEDIUM PRIORITY
Verify QA-004 (sparse heatmap):
- Test with production data (not sandbox)
- Check if ActivityHeatmap renders correctly with dense data
- Verify date range calculation (should show 16 weeks per TASK-609)

**Test Script:**
```typescript
// Add to stats.spec.ts
test('heatmap should show at least 50 cells for 16 weeks', async ({ page }) => {
  const cells = await page.locator('[class*="heatmap"] > *').count();
  expect(cells).toBeGreaterThan(50); // 16 weeks * ~5 days = ~80 cells
});
```

---

## Artifact Locations

### Existing Files
- âœ… `web/e2e/__snapshots__/stats.spec.ts-snapshots/stats-page-full.png`
- âœ… `example_ui/statistics-charts.png` (reference design)
- âœ… `web/src/components/stats/StatsView.tsx`
- âœ… `web/src/components/stats/StatsView.css`
- âœ… `web/src/stores/statsStore.ts`

### Expected Files (Not Created)
- âŒ `/tmp/qa-TASK-615/` (blocked by worktree isolation)
- âŒ Full-page mobile screenshot (375x667)
- âŒ Chart section screenshots
- âŒ Table section screenshots
- âŒ Console error logs

---

**Analysis Date:** 2026-01-28
**Method:** Code inspection + screenshot annotation
**Coverage:** Partial (visual confirmation limited to top 40% of page)
**Confidence:** High for identified issues, but incomplete coverage
