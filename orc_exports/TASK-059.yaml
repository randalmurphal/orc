task:
    id: TASK-059
    title: Add lightweight criteria phase to medium weight tasks
    description: |-
        Medium weight tasks currently jump straight to implement without any upfront planning. Add a new 'criteria' phase that runs before implement for medium weight tasks.

        The criteria phase should focus on:
        - Clear success criteria (what does done look like?)
        - Test scenarios (happy path, edge cases, error conditions)
        - Quick scope verification

        This is NOT full architectural planning like large/greenfield - no component breakdown or API design. Just enough to establish clear completion criteria before coding begins.

        Changes needed:
        1. Update templates/plans/medium.yaml to add criteria phase before implement
        2. Create templates/prompts/criteria.md with the lightweight planning prompt
        3. Update docs to reflect the new phase sequence
        4. Update CLAUDE.md phase documentation

        New medium sequence: criteria → implement → test → docs
    weight: medium
    status: planned
    branch: orc/TASK-059
    requires_ui_testing: true
    testing_requirements:
        unit: true
        visual: true
    created_at: 2026-01-13T15:32:23.256036-06:00
    updated_at: 2026-01-13T15:32:23.267103-06:00
plan:
    version: 1
    task_id: TASK-059
    weight: medium
    description: Medium task - implement with review, fully automated
    phases:
        - id: implement
          name: implement
          prompt: |
            Implement the following feature/task:

            **Task**: {{TASK_TITLE}}

            **Description**: {{TASK_DESCRIPTION}}

            {{RETRY_CONTEXT}}

            1. Plan your implementation approach
            2. Implement the required changes
            3. Write/update tests alongside code
            4. Run tests and fix any failures

            Keep iterating until implementation is complete and tests pass.

            When done, output:
            <phase_complete>true</phase_complete>
          gate:
            type: auto
          checkpoint: true
          status: pending
        - id: test
          name: test
          prompt: |
            Test and review the implementation:

            **Task**: {{TASK_TITLE}}

            **Original task**: {{TASK_DESCRIPTION}}

            1. Run the full test suite
            2. Review code for quality issues
            3. Check for edge cases and security issues
            4. Fix any problems found

            Keep iterating until all tests pass and code quality is acceptable.

            When done, output:
            <phase_complete>true</phase_complete>
          depends_on:
            - implement
          gate:
            type: auto
          checkpoint: true
          status: pending
        - id: docs
          name: docs
          prompt: |
            Update documentation for:

            **Task**: {{TASK_TITLE}}

            **Description**: {{TASK_DESCRIPTION}}

            1. Update any relevant documentation files
            2. Ensure CLAUDE.md reflects the changes if applicable
            3. Add/update code comments where needed
            4. Update README if user-facing changes were made

            Keep iterating until documentation is complete.

            When done, output:
            <phase_complete>true</phase_complete>
          depends_on:
            - test
          gate:
            type: auto
          checkpoint: true
          status: pending
