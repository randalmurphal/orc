/* ─────────────────────────────────────────────────────────────────────────────
   PhaseNode - Redesigned custom React Flow node for workflow phases
   Based on mockup: example_ui/example_workflows/workflows_editor.png
   ───────────────────────────────────────────────────────────────────────────── */

.phase-node {
	position: relative;
	background: var(--bg-card);
	border: 1px solid var(--border);
	border-radius: var(--radius-lg);
	min-width: 200px;
	max-width: 260px;
	overflow: hidden;
	transition:
		transform var(--duration-fast) var(--ease-out),
		box-shadow var(--duration-fast) var(--ease-out),
		border-color var(--duration-fast) var(--ease-out);
}

/* ─── Category Color Accents (left border) ───────────────────────────────────── */

.phase-node::before {
	content: '';
	position: absolute;
	left: 0;
	top: 0;
	bottom: 0;
	width: 4px;
	background: var(--text-muted);
	border-radius: var(--radius-lg) 0 0 var(--radius-lg);
}

.phase-node--category-spec::before {
	background: var(--blue);
}

.phase-node--category-impl::before {
	background: var(--green);
}

.phase-node--category-quality::before {
	background: var(--orange);
}

.phase-node--category-docs::before {
	background: var(--primary);
}

.phase-node--category-other::before {
	background: var(--text-muted);
}

/* ─── Content Area ───────────────────────────────────────────────────────────── */

.phase-node__content {
	padding: var(--space-3);
	padding-left: calc(var(--space-3) + 4px); /* Account for accent border */
}

/* ─── Header: Name + Badge ───────────────────────────────────────────────────── */

.phase-node__header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: var(--space-2);
	margin-bottom: var(--space-1);
}

.phase-node__name {
	font-family: var(--font-body);
	font-size: var(--text-lg);
	font-weight: var(--font-semibold);
	color: var(--text-primary);
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	line-height: var(--leading-tight);
}

/* ─── Type Badge (AI / Human / Skip) ─────────────────────────────────────────── */

.phase-node__badge {
	flex-shrink: 0;
	display: inline-flex;
	align-items: center;
	padding: var(--space-0-5) var(--space-1-5);
	font-family: var(--font-body);
	font-size: var(--text-xs);
	font-weight: var(--font-medium);
	text-transform: uppercase;
	letter-spacing: var(--tracking-wide);
	border-radius: var(--radius-sm);
}

.phase-node__badge--ai {
	background: var(--primary-dim);
	color: var(--primary);
}

.phase-node__badge--human {
	background: var(--cyan-dim);
	color: var(--cyan);
}

.phase-node__badge--skip {
	background: var(--bg-hover);
	color: var(--text-muted);
}

/* ─── Template ID ────────────────────────────────────────────────────────────── */

.phase-node__id {
	display: block;
	font-family: var(--font-mono);
	font-size: var(--text-sm);
	color: var(--text-muted);
	margin-bottom: var(--space-1);
}

/* ─── Description ────────────────────────────────────────────────────────────── */

.phase-node__description {
	margin: var(--space-1-5) 0 0 0;
	font-family: var(--font-body);
	font-size: var(--text-sm);
	color: var(--text-secondary);
	line-height: var(--leading-snug);
}

/* ─── Execution Footer ───────────────────────────────────────────────────────── */

.phase-node__footer {
	display: flex;
	gap: var(--space-2);
	margin-top: var(--space-2);
	padding-top: var(--space-2);
	border-top: 1px solid var(--border);
}

.phase-node__stat {
	font-family: var(--font-mono);
	font-size: var(--text-xs);
	color: var(--text-muted);
}

/* ─── Hover State ────────────────────────────────────────────────────────────── */

.phase-node:hover {
	transform: translateY(-1px);
	box-shadow: var(--shadow-md);
	border-color: var(--border-hover);
}

/* ─── Selected State ─────────────────────────────────────────────────────────── */

.phase-node--selected {
	border-color: var(--primary);
	box-shadow: var(--shadow-glow-sm);
}

.phase-node--selected:hover {
	box-shadow: var(--shadow-glow);
}

/* ─── Status States ──────────────────────────────────────────────────────────── */

.phase-node--running {
	border-color: var(--primary);
	box-shadow: 0 0 12px var(--primary-glow);
	animation: phase-pulse 2s ease-in-out infinite;
}

.phase-node--completed::before {
	background: var(--green) !important;
}

.phase-node--completed {
	border-color: rgba(16, 185, 129, 0.3);
}

.phase-node--failed::before {
	background: var(--red) !important;
}

.phase-node--failed {
	border-color: rgba(239, 68, 68, 0.3);
}

.phase-node--skipped {
	opacity: 0.5;
}

.phase-node--skipped .phase-node__name {
	text-decoration: line-through;
}

.phase-node--pending {
	opacity: 0.7;
}

.phase-node--blocked::before {
	background: var(--orange) !important;
}

.phase-node--blocked {
	opacity: 0.6;
	border-color: rgba(249, 115, 22, 0.3);
}

/* ─── Animations ─────────────────────────────────────────────────────────────── */

@keyframes phase-pulse {
	0%, 100% {
		box-shadow: 0 0 8px var(--primary-glow);
	}
	50% {
		box-shadow: 0 0 20px var(--primary-glow);
	}
}
